---
title: Instituto Tecnol√≥gico de Costa Rica

subtitle: Proyecto de Estad√≠stica

author: 
- \n
- "Integrantes:"
- \n
- Jose Ignacio Alfaro Solano
- Marco Antonio Espinoza Salas
- Warner Fidel Hurtado Laguna
- Lester Alexander Trejos Berm√∫dez
- \n
- "Profesor:"
- \n
- Esteban Ballestero Alfaro
- \n
- "Fecha:"
- \n

date: "12/05/2021"
output:
  word_document: default
  html_document: default
---
\newpage

### Nombre de la base de datos

nycflights13

### Descripci√≥n del dataset seleccionado

La base utilizada para el proyecto contiene informaci√≥n sobre todos los vuelos que sal√≠an de NUEVA YORK (por ejemplo EWR, JFK Y LGA)a destinos en los Estados Unidos, Puerto Rico y las Islas V√≠rgenes Americanas) en 2013: 336,776 vuelos en total. Para ayudar a comprender qu√© provoca retrasos, tambi√©n incluye otros conjuntos de datos √∫tiles. La base que est√° siendo utilizada contiene muchas tablas de datos como vuelos, climas, aviones, aeropuertos etc, para el desarrollo del presente proyecto se eligi√≥ la columna flights o vuelos. 

El paquete flights o vuelos se divide en varias columnas como a√±o, hora de salida, minutos, avi√≥n, origen destino y muchos otros. Para el manejo de este proyecto se trabaj√≥ con tres columnas respectivas, la de origen, destino y duraci√≥n en el aire, las cuales fueron utilizadas en pruebas de una y dos poblaciones. Para la prueba se tomaron un origen y un destino en el cual se toma la duraci√≥n entre ese respectivo origen y destino.

- \n
- \n

### Librer√≠as necesarias

- \n

if (!require('devtools')) install.packages('devtools')
devtools::install_github('fhernanb/stests', force=TRUE)


```{r}
library(nycflights13)
library(mosaicData)

library(PASWR2)

#library(stests)

library(BSDA)

library(visdat)
library(remotes)

library(DataExplorer)
library(MASS)
library(TeachingDemos)
library(ggplot2)
library(datos)
library(fBasics)
library(nortest)
library(EnvStats)
library(corrr)
library(ggplot2)
library(ggcorrplot)
library(bbmle)
library(DALEX)
data("flights")

mosaicData <- mosaicData::KidsFeet

dataFlight <- flights
dataDiamonds <- ggplot2::diamonds

dataFlight
mosaicData


#if (!require('devtools')) install.packages('devtools')
#devtools::install_github('fhernanb/stests', force=TRUE)
```

- \n

### Variables de la base datos

- \n

```{r}
dataFlight
dataDiamonds
```


- \n

### Resumen de variables seleccionadas

#### La siguiente variable fue utilizada para una y dos poblaciones, en donde se utilizaba la duraci√≥n en aire de un destino al otro.

![Variables para una poblaci√≥n](tUnapoblacion.png)
-\n


![Variables para una y dos poblaciones](tDospoblaciones.png)

- \n 

### Gr√°ficos 
```{r}
dataFlight <- flights
plot_missing(dataFlight)
```

El gr√°fico anterior nos demuestra que la escogencia de los datos est√° basada en una base datos confiable, ya que
como se puede observar, los datos presentan un buen comportamiento. Tambi√©n, se presentan datos en blanco, pero el porcentaje es muy peque√±o lo cual hace que el dataset sea √≥ptimo para hacer c√°lculos estad√≠sticos.

- \n

- \n

```{r}
dataFlight <- flights
vuelos <- na.omit(dataFlight)
vis_dat(vuelos,warn_large_data = FALSE)

```

En el gr√°fico anterior, se puede observar los tipos de variables, el nombre que cada una tiene, as√≠ como la cantidad de datos que contienen. Cabe resaltar que para este gr√°fico se eliminaron los valores en blanco.

# Pruebas de intervalos de confianza para una poblaci√≥n

- \n


## **Distribuci√≥n normal Z**

En la siguiente prueba se proceder√° a realizar los respectivos procedimientos con la distribuci√≥n normal z, en la cual se tomar√° un nivel de confianza del 95%.
Se tomaron datos de una poblaci√≥n con un comportamiento normal. Se tomaron los tiempos en vuelo de todos los vuelos de origen JFK y destino MIA, este es el valor de 'x' en la funci√≥n. Para el valor del sigma.x se tom√≥ la desviaci√≥n est√°ndar de esos tiempos en aire de los vuelos y el conf.level significa el nivel de confianza para el intervalo, que es nuestro caso es de 95%. Para esta prueba se us√≥ la librer√≠a 'BSDA'.

- \n

### **Resultados**
```{r}

#En la siguiente asignaci√≥n se toman la cantidad del tiempo de aire de los vuelos que salen de JFK y tienen como destino MIA, y  guarda en var1 s√≥lo los vuelos con dichas caracter√≠sticas.
var1 <- na.omit(dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "MIA", ]$air_time)

#En esta variable se trabaja con el tiempo en el aire de el origen y destino seleccionado anteriormente.

#Se procede a aplicar la funci√≥n de PASWR2, en la cual se le pasan como parametros la lista de tiempos, la desviaci√≥n estandar y por √∫ltimo el nivel de significancia.
BSDA:: z.test(x = var1, sigma.x = sd(var1), conf.level = 0.95)$conf.int

```

- \n

### **Conclusi√≥n**
Al realizar los respectivos c√°lculos de la distribuci√≥n normal z con '3285'que es cantidad de tiempos de vuelos con origen JFK y destino a MIA se obtuvo un intervalo de confianza de 95% para el promedio del tiempo de vuelo desde JFK a MIA dado por: ]151.7496, 152.5103[.

- \n

## **Distribuci√≥n T**

En la siguiente prueba se proceder√° a realizar los respectivos c√°lculos con la distribuci√≥n TStudent, en la cual se tomar√° un nivel de confianza del 95%. Esta distribuci√≥n debe tener un n < 30, por lo que se tom√≥ una muestra aleatoria de tama√±o 25, correspondientes a la columna de *air_time* para dicha prueba. Cabe destacar que la poblaci√≥n presenta un compartamiento normal. Para esta prueba se us√≥ la librer√≠a 'stats'.

- \n

### **Resultados**
```{r}
#En la siguiente asignaci√≥n se toman las n cantidad de vuelos que salen de JFK y tienen como destino MIA, y guarda en var1 s√≥lo los vuelos con dichas caracter√≠sticas.

#En esta variable se trabaja con el tiempo (air-time) en el aire de el origen y destino seleccionados el cual se van a utilizar 25 datos de manera aleatoria
var1 <- sample(x = na.omit(dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "MIA", ]$air_time), size = 25, replace = TRUE)

#Se procede a aplicar la funci√≥n T, en la cual se le pasan como parametros la lista de tiempos y por √∫ltimo el nivel de significancia.
stats::t.test(var1, conf.level = 0.95)$conf.int
```

- \n

### **Conclusi√≥n**
Al realizar los respectivos c√°lculos de la distribuci√≥n TStudent con una muestra aleatoria de tama√±o 25,que representa la cantidad de tiempos de vuelos con origen JFK y destino a MIA se obtuvo un intervalo de confianza de 95% dado por: ]146.9743, 157.1857[.


- \n

## **Una proporci√≥n**

Para realizar el respectivo c√°lculo de la proporci√≥n de tiempos de vuelo se tomaron todos los vuelos menores o iguales que 150, en la cual se tomar√° un nivel de confianza del 95%. La poblaci√≥n ser√≠a los tiempos de vuelos, y como "√©xitos" los vuelos con un tiempo de vuelo menor a 150. La poblaci√≥n se comporta de manera normal. Cabe destacar que para esta prueba se us√≥ la librer√≠a 'stats'.

- \n

### **Resultados**
```{r}
#En la siguiente asignaci√≥n se toman las n cantidad de vuelos que salen de JFK y tienen como destino MIA, y guarda en var1 s√≥lo los vuelos con dichas caracter√≠sticas.
var1 <- dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "MIA", ]

#En la siguiente variable se asignan los √©xitos obtenidos de la condici√≥n n <= 100
exitos <- var1[which(na.omit(var1$air_time) <= 150), ]

#En esta variable se trabaja con el tiempo en el aire de el origen y destino seleccionado anteriormente
var1 <- na.omit(var1$air_time)


#Se obtiene la cantidad total de √©xitos de la variable anterior √©xitos
totalExitos <- length(exitos$air_time)


#Para obtener la proporci√≥n se procede a ingresar el total de √©xitos, el total de todas las variables y por √∫ltimo el nivel de confianza
stats::prop.test(totalExitos, length(var1), conf.level = 0.95)$conf.int

```

- \n

### **Conclusi√≥n**
Al realizar los respectivos c√°lculos de la proporci√≥n con la cantidad de tiempos de vuelos de origen JFK a destino MIA menores a 150 minutos, se obtuvo un intervalo de confianza de 95%, dado por: ]0.4677168, 0.5021818[.

## **Varianza**

En la √∫ltima prueba para una poblaci√≥n, se procede a realizar los c√°lculos con un intervalo de confianza del 95%, en la cual se utiliza la cantidad total de las variables *air_time* para una mejor estimaci√≥n. Para realizar la siguiente estimaci√≥n del intervalo de confianza se tom√≥ una poblaci√≥n que sigue una distribuci√≥n normal. Cabe resaltar que para esta prueba se us√≥ la librer√≠a 'stests'.

- \n

### **Resultados**
```{r}
#En la siguiente asignaci√≥n se toman los n cantidad de vuelos que salen de JFK y tienen como destino MIA, y guarda en var1 s√≥lo los vuelos con dichas caracter√≠sticas.
var1 <- na.omit(dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "MIA", ]$air_time)

#En la siguiente funci√≥n de stests se procede a ingresar la lista de los tiempos y luego el nivel de confianza
stests:: var.test(x = var1, conf.level = 0.95)$conf.int

```

- \n

### **Conclusi√≥n**
Al realizar el an√°lisis de la variancia mediante la estimaci√≥n por intervalo de confianza  de 95% para los tiempos de vuelos de origen JFK a destino MIA se obtuvo el siguiente IC: ]117.9459 129.9276[.


- \n

- \n

# Pruebas de intervalos de confianza para dos poblaciones

- \n

## **Una diferencia de promedios usando distribuci√≥n Z para dos poblaciones**

En la siguiente prueba se proceder√° a realizar los respectivos an√°lisis con la distribuci√≥n normal z, en la cual se tomar√° un nivel de confianza del 95%. Para dicha prueba se toman dos diferentes poblaciones, cada poblaci√≥n tiene un mismo origen y destinos distintos. Ambas poblaciones siguen un comportamiento normal. Para esta prueba se us√≥ la librer√≠a 'BSDA'.

- \n

### **Resultados**
```{r}
#En la siguiente asignaci√≥n se toman la cantidad de tiempo en el aire de los vuelos que salen de JFK y tienen como destino MIA, y guarda en var1 s√≥lo los vuelos con dichas caracter√≠sticas.
prueba1 <- na.omit(dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "MIA", ]$air_time)

#Estos son los n cantidad de vuelos que salen de JFK y tienen como destino RDU
prueba2 <- na.omit(dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "RDU", ]$air_time)

#Para la respectiva prueba se ingresan como para metros la primera poblaci√≥n, luego la segunda, seguidamente la desviaci√≥n est√°ndar de cada una, en el mismo orden y por √∫ltimo el nivel de confianza
BSDA:: z.test(prueba1, prueba2, sigma.x = sd(prueba1), sigma.y = sd(prueba2), conf.level = 0.95 )$conf.int
```

- \n

### **Conclusi√≥n**
Al realizar los respectivos c√°lculos de las dos poblaciones con la distribuci√≥n normal z, con un n1 = cantidad de tiempos de vuelos de JFK a MIA y un n2 = cantidad de tiempos de vuelos de JFK a RDU. Para dicha prueba se obtuvo un intervalo de confianza de: ]79.82943, 80.71615[; con un nivel de confianza del 95%.

En conclusi√≥n, el valor del promedio de la primera poblaci√≥n *prueba1* es mayor, ya que los valores de los intervalos de confianza son ambos positivos, por ende, no se puede asumir una igualdad de medias, porque el 0 no est√° presente.

- \n

## **Diferencia de promedios utilizando distribuci√≥n T para dos poblaciones**

En la siguiente prueba se proceder√° a realizar los respectivos c√°lculos con la distribuci√≥n T, en la cual se tomar√° un nivel de confianza del 95%. Esta distribuci√≥n debe tener un n < 30, por lo que se tomaron 25 datos aleatorios en ambas poblaciones de la columna de *air_time* para dicha prueba. Las poblaciones que contienen las dos muestras siguen una distribuci√≥n normal. Para esta prueba se us√≥ la librer√≠a 'stats'.

- \n

### **Resultados**
```{r}
#En la siguiente asignaci√≥n se toman los n cantidad de vuelos que salen de JFK y tienen como destino MIA, y guarda en var1 s√≥lo los vuelos con dichas caracter√≠sticas.
var1 <- na.omit(dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "MIA", ]$air_time)

#Estos son los n cantidad de vuelos que salen de JFK y tienen como destino RDU
var2 <- na.omit(dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "RDU", ]$air_time)

#Se extraen aleatoriamente 25 datos como muestra de la primera poblacion
prueba1 <- sample(x = var1, size = 25, replace = TRUE)

#Se extraen aleatoriamente 25 datos como muestra de la segunda poblacion
prueba2 <- sample(x = var2, size = 25, replace = TRUE)

#Para esta funci√≥n solamente se ingresan las pruebas y el nivel de confianza.
stats::t.test(prueba1, prueba2, conf.level = 0.95)$conf.int

```

- \n

### **Conclusi√≥n**
Al realizar los respectivos c√°lculos de las dos muestras de las poblaciones con la distribuci√≥n tStudent, con el n1 = 25 y n2 = 25 tiempos de vuelo de los vuelos de origen JFK a destino MIA y de origen  JFK a destino RDU, se obtuvo un intervalo de confianza de: ]75.78145, 84.13855[; con un nivel de confianza del 95%.

En conclusi√≥n, el valor de la media de la primera muestra es mayor, ya que los resultados de los intervalos de confianza son positivos, por ende, no se asume igualdad, ya que, el cero no est√° presente.Por ende, se asumen diferencia en los grupos.

- \n

## **Diferencia de proporciones para dos poblaciones**

En esta prueba se trabaja con el tiempo en el aire del origen y del destino seleccionados en el siguiente c√≥digo para ambas poblaciones, donde se seleccionan los viajes menores o iguales a 150 minutos como los '√©xitos'. Para la respectiva prueba se utiliza un nivel de confianza de 95%. Para la estimaci√≥n del intervalo de confianza se tomaron dos poblaciones en las que ambas siguen un comportamiento normal. Para esta prueba se us√≥ la librer√≠a 'stats'.

- \n

### **Resultados**
```{r}
#En la siguiente asignaci√≥n se toman los n cantidad de vuelos que salen de JFK y tienen como destino MIA, y guarda en var1 s√≥lo los vuelos con dichas caracter√≠sticas.
prueba1 <- na.omit(dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "MIA", ]$air_time)

#Estos son los n cantidad de vuelos que salen de JFK y tienen como destino RDU
prueba2 <- na.omit(dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "RDU", ]$air_time)


#El tama√±o de p1 y p2 son los √©xitos de los vuelos que tienen un tiempo menor o igual a 150
exitoP1 <- length(which(prueba1 <= 150))
exitoP2 <- length(which(prueba2 <= 150))

#Usando la funci√≥n de prop.test se sacan los intervalos de confianza respectivos, primero con los
#√©xitos de la poblaci√≥n 1 y su respectivo tama√±o, y segundo con la poblaci√≥n 2
stats::prop.test(x = c(exitoP1, exitoP2), n = c(length(prueba1), length(prueba2)), conf.level = 0.95)$conf.int

#Usando la funci√≥n de prop.test se sacan los intervalos de confianza respectivos, primero con los
#√©xitos de la poblaci√≥n 2 y su respectivo tama√±o, y segundo con la poblaci√≥n 1
stats::prop.test(x = c(exitoP2, exitoP1), n = c(length(prueba2), length(prueba1)), conf.level = 0.95)$conf.int
```

- \n

### **Conclusi√≥n**
Al realizar los respectivos c√°lculos de las dos poblaciones con la distribuci√≥n normal, con el p1 = cantidad de tiempos de vuelo, de 1000 vuelos de JFK a MIA y p2 = cantidad de tiempo de vuelo de 1000 vuelos de JFK a RDU, se obtuvo un intervalo de confianza de: ]-0.5324788, -0.4976582[; con un nivel de confianza del 95%.

Intercambiando los √©xitos y los p estimadores, se obtiene un intervalo de confianza  ]0.4976582, 0.5324788[; con un nivel de confianza del 95%.

En conclusi√≥n, se destaca que proporci√≥n para p2 es mayor, ya que al aplicar las diferencias se obtienen
resultados negativos y al intercambiar p1 estimador por p2 estimador se obtienen resultados positivos, por ende, el valor de p2 estimador es mayor. Y no se puede asumir una igualdad de proporciones, ya que, el 0 no se encuentra en los intervalos.

- \n

## **Cociente de variancias de dos poblaciones**

Para la √∫ltima prueba con dos poblaciones se utiliza un nivel de confianza del 95%.Para realizar los siguientes c√°lculos se tomaron dos poblaciones en la cuales ambas siguen una distribuci√≥n normal. Para la primera poblaci√≥n se dispuso del tiempo de vuelo de los vuelos con origen JFK y con destino MIA, y para la segunda, lo mismo nada m√°s que el destino es RDU. Para esta prueba se us√≥ la librer√≠a 'stests'.

- \n

### **Resultados**
```{r}
#En la siguiente asignaci√≥n se toman la cantidad de tiempo de aire de los vuelos que salen de JFK y tienen como destino MIA, y guarda en var1 s√≥lo los vuelos con dichas caracter√≠sticas.
var1 <- dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "MIA", ]

#Esta es la cantidad de tiempo de aire de los vuelos que salen de JFK y tienen como destino RDU
var2 <- dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "RDU", ]

#Para la siguiente funci√≥n se le pasa la columna de air_time de ambas variables y por √∫ltimo el nivel de confianza.
stests:: var.test( na.omit(var1$air_time),  na.omit(var2$air_time), conf.level = 0.95)$conf.int
```

- \n

### **Conclusi√≥n**
Al realizar los respectivos c√°lculos de las dos poblaciones con la distribuci√≥n f, para cociente de varianzas, se obtuvo un intervalo de confianza de: ]2.862129, 3.293065[, con un nivel de confianza del 95%.

En conclusi√≥n, con los resultados obtenidos, la varianza del numerador, que representa a la cantidad de tiempo de aire de los vuelos que tienen como origen JFK y destino MIA es mayor a la varianza del denominador, que es la cantidad de tiempo de aire de los vuelos con el mismo origen, pero con destino en RDU.
Por ende, no se puede asumir igualdad de varianzas, ya que el 1 no se encuentra en los intervalos.

\newpage
- \n
- \n

###  An√°lisis Inferencial (pruebas de hip√≥tesis de una y dos poblaciones)
- \n
Para la realizaci√≥n de este an√°lisis con las pruebas de hip√≥tesis se utilizar√° la misma base de datos usada en la primera entrega del proyecto, nycflights13.
- \n

### Resumen de variables seleccionadas

#### La siguiente variable fue utilizada para una y dos poblaciones, en donde se utilizaba la duraci√≥n en aire de un destino al otro.

![Variables para una poblaci√≥n y dos poblaciones](resumenVariablesEstadistica.png)

\newpage

# Pruebas de hip√≥tesis para una poblaci√≥n

- \n

## **Distribuci√≥n normal**

En la siguiente prueba se proceder√° a realizar los respectivos procedimientos con la distribuci√≥n normal est√°ndar, en la cu√°l se tomar√° un nivel de significancia del 95%.
Se tomaron datos correspondientes al tiempo de vuelo de los vuelos con origen en JFK y con destino en MIA, sobre el cu√°l se quiere estimar que el promedio de vuelo es igual a 120 minutos. Para esto se plantean las siguientes hip√≥tesis:   $H_0: \mu = 120 \\$
- \n
$H_1: \mu \neq 120$
Seguidamente, para validar lo planteado anteriormente, se realizar√° una prueba de hip√≥tesis para promedio de una poblaci√≥n, utilizando un nivel de confianza de 95%
que es para elegir si queremos cola izquierda, cola derecha o dos colas; para este caso se usar√° una prueba de dos colas dado que el tama√±o de muestra es mayor que 30.

- \n

### **Resultados**
```{r}

#En la siguiente asignaci√≥n se toman la n cantidad de vuelos que salen de JFK y tienen como destino MIA, y  guarda en var1 s√≥lo los vuelos con dichas caracter√≠sticas.
var1 <- na.omit(dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "MIA", ]$air_time)

#En esta variable se trabaja con el tiempo en el aire de el origen y destino seleccionado anterionrmente

#Se procede a aplicar la funci√≥n de TeachingDemos, en la cu√°l se le pasan como parametros la lista de tiempos, la desviaci√≥n estandar, el p√°rametro y el tipo de prueba.
TeachingDemos::z.test(var1, sd(var1),mu = 120,alternative = "two.sided")

```

- \n

### **Conclusi√≥n**


- \n

## **Distribuci√≥n T**

En la siguiente prueba se proceder√° a realizar los respectivos procedimientos con la distribuci√≥n TStudent, en la cu√°l se tomar√° un nivel de significancia del 95%.
Se tom√≥ una muestra con un tama√±o de 25 correspondientes al tiempo de vuelo de los vuelos con origen en JFK y con destino en MIA, sobre el cu√°l se quiere estimar que el promedio de vuelo es menor a 120 minutos. Para esto se plantean las siguientes hip√≥tesis:   $H_0: \mu = 120(\ge) \\$
$H_1: \mu < 120$
Seguidamente, para validar lo planteado anteriormente, se realizar√° una prueba de hip√≥tesis para promedio de una poblaci√≥n, utilizando un nivel de confianza de 95%, eligiremos si la prueba va a ser de cola izquierda, cola derecha o dos colas; para este caso se usar√° una prueba de cola izquierda.

- \n

### **Resultados**
```{r}
set.seed(2021)
#En la siguiente asignaci√≥n se toman las n cantidad de vuelos que salen de JFK y tienen como destino MIA, y guarda en var1 s√≥lo los vuelos con dichas caracter√≠sticas.

#En esta variable se trabaja con el tiempo (air-time) en el aire de el origen y destino seleccionados el cual se van a utlizar 25 datos de manera random
var1 <- sample(x = na.omit(dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "MIA", ]$air_time), size = 25, replace = TRUE)

#Se procede a aplicar la funci√≥n T, en la cual se le pasan como parametros la lista de tiempos y por √∫ltimo el nivel de significancia.
stats::t.test(var1,mu = 120, alternative = "less" )
```

- \n

### **Conclusi√≥n**



- \n

## **Una proporci√≥n**

En la siguiente prueba se proceder√° a realizar los respectivos procedimientos con la distribuci√≥n normal est√°ndar, en la cu√°l se tomar√° un nivel de significancia del 95%.
Se tomaron datos correspondientes al tiempo de vuelo de los vuelos con origen en JFK y con destino en MIA, sobre el cu√°l se quiere estimar que, como m√°ximo el 50% de los vuelos tienen un tiempo de vuelo menor a 150 minutos . Para esto se plantean las siguientes hip√≥tesis:   $H_0: p = 0.5(\le) \\$
$H_1: p > 0.5$
Seguidamente, para validar lo planteado anteriormente, se realizar√° una prueba de hip√≥tesis para una proporci√≥n de una poblaci√≥n que sigue una distribuci√≥n normal, utilizando un nivel de confianza de 95%, eligiremos si la prueba va a ser de cola izquierda, cola derecha o dos colas; para este caso se usar√° una prueba de cola derecha.

- \n

### **Resultados**
```{r}
#En la siguiente asignaci√≥n se toman las n cantidad de vuelos que salen de JFK y tienen como destino MIA, y guarda en var1 s√≥lo los vuelos con dichas caracter√≠sticas.
var1 <- dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "MIA", ]

#En la siguiente variable se asignan los √©xitos obtenidos de la condioci√≥n n <= 100
exitos <- var1[which(na.omit(var1$air_time) <= 150), ]

#En esta variable se trabaja con el tiempo en el aire de el origen y destino seleccionado anterionrmente
var1 <- na.omit(var1$air_time)


#Se obtiene la cantidad total de √©xitos de la variable anterior √©xitos
totalExitos <- length(exitos$air_time)
p = totalExitos/length(var1)
q= 1-p

n1 = p * length(var1)
n2 = q * length(var1)
n1
n2

#El n multiplicado por el p mayor que 5, muestra grande. Tambi√©n con la q

#Para obtener la proporci√≥n se procede a ingresar el total de √©xitos, el total de todas las variables y por √∫ltimo el nivel de confianza
stats::prop.test(totalExitos, length(var1),p = 0.5,alternative = "greater", conf.level = 0.95)

```

- \n

### **Conclusi√≥n**


- \n
## **Varianza**

En la siguiente prueba se proceder√° a realizar los respectivos procedimientos con la distribuci√≥n Chi-Square, en la cu√°l se tomar√° un nivel de significancia del 95%.
Se tomaron datos correspondientes al tiempo de vuelo de los vuelos con origen en JFK y con destino en MIA, sobre el cu√°l se quiere contrastar que la varianza del tiempo de aire los vuelos es menor que 0.6. Para esto se plantean las siguientes hip√≥tesis:   $H_0: \sigma^2 = 100(\ge) \\$
$H_1: \sigma^2 < 100$
Seguidamente, para validar lo planteado anteriormente, se realizar√° una prueba de hip√≥tesis para una varianza de una poblaci√≥n que sigue una distribuci√≥n normal, utilizando un nivel de confianza de 95%, eligiremos si la prueba va a ser de cola izquierda, cola derecha o dos colas; para este caso se usar√° una prueba de cola izquierda.

- \n

### **Resultados**
```{r}
#En la siguiente asignaci√≥n se toman los n cantidad de vuelos que salen de JFK y tienen como destino MIA, y guarda en var1 s√≥lo los vuelos con dichas caracter√≠sticas.
var1 <- na.omit(dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "MIA", ]$air_time)

#En la siguiente funci√≥n de stests se procede a igresar la lista de los tiempos y luego el nivel de confianza
TeachingDemos:: sigma.test(var1, sigmasq = 100,alternative = "less", conf.level = 0.95)

```

- \n

### **Conclusi√≥n**



- \n
- \n

# Pruebas de hip√≥tesis para dos poblaciones


## **Una diferencia de promedios usando distribuci√≥n normal est√°ndar para dos poblaciones**

En la siguiente prueba se proceder√° a realizar los respectivos procedimientos con la distribuci√≥n normal est√°ndar, en la cu√°l se tomar√° un nivel de significancia del 95%.
Se tomaron datos correspondientes al tiempo de vuelo de los vuelos con origen en JFK y con destino en MIA como el primer promedio, luego del mismo modo, se tomaron datos correspondientes  al tiempo de vuelo de los vuelos con origen en JFK y con destino en MIA, como segundo promedio.Se quiere estimar que la diferencia de los promedios de los vuelos es igual a 0 minutos. Para esto se plantean las siguientes hip√≥tesis:   $H_0: \mu_1 -\mu_2 = 0 \\$
\n
$H_1: \mu_1 -\mu_2 \neq 0$
Seguidamente, para validar lo planteado anteriormente, se realizar√° una prueba de hip√≥tesis para una diferencia de promedios de dos poblaciones, utilizando un nivel de confianza de 95% que es para elegir si queremos cola izquierda, cola derecha o dos colas; para este caso se usar√° una prueba de dos colas dado que el tama√±o de las muestras es mayor que 30.

- \n

### **Resultados**
```{r}
#En la siguiente asignaci√≥n se toman los n cantidad de vuelos que salen de JFK y tienen como destino MIA, y guarda en var1 s√≥lo los vuelos con dichas caracter√≠sticas.
prueba1 <- na.omit(dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "MIA", ]$air_time)

#Estos son los n cantidad de vuelos que salen de JFK y tienen como destino RDU
prueba2 <- na.omit(dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "RDU", ]$air_time)

#Para la respectiva prueba se ingresan como para metros la primera poblaci√≥n, luego la segunda, seguidamente la desviaci√≥n estandar de cada una, en el mismo orden y por √∫ltimo el nivel de confianza

PASWR2::z.test(prueba1, sigma.x = sd(prueba1),prueba2, sigma.y = sd(prueba2),alternative = "two.sided")
```

- \n

### **Conclusi√≥n**


- \n

## **Diferencia de promedios utilizando distribuci√≥n T para dos poblaciones**

En la siguiente prueba se proceder√° a realizar los respectivos procedimientos con la distribuci√≥n TStudent, en la cu√°l se tomar√° un nivel de significancia del 95%.
Se tom√≥ una muestra con un tama√±o de 25 correspondientes al tiempo de vuelo de los vuelos con origen en JFK y con destino en MIA para la primera poblaci√≥n, del mismo modo se tom√≥ una muestra con un tama√±o de 25 correspondientes al tiempo de vuelo de los vuelos con origen en JFK y con destino en RDU para la segunda poblaci√≥n, sobre las cu√°les se pretende estimar que la diferencia de los promedios de los vuelo es igual a 0 minutos. Para esto se plantean las siguientes hip√≥tesis:   $H_0: \mu_1 -\mu_2 = 0 \\$
\n 
$H_1: \mu_1 -\mu_2 \neq 0$
Seguidamente, para validar lo planteado anteriormente, se realizar√° una prueba de hip√≥tesis para diferencia de promedios de dos poblaciones, utilizando un nivel de confianza de 95%, eligiremos si la prueba va a ser de cola izquierda, cola derecha o dos colas; para este caso se usar√° una prueba de dos colas. 

- \n

### **Resultados**
```{r}
#En la siguiente asignaci√≥n se toman los n cantidad de vuelos que salen de JFK y tienen como destino MIA, y guarda en var1 s√≥lo los vuelos con dichas caracter√≠sticas.
set.seed(2021)
var1 <- na.omit(dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "MIA", ]$air_time)

#Estos son los n cantidad de vuelos que salen de JFK y tienen como destino RDU
var2 <- na.omit(dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "RDU", ]$air_time)

#Se extraen aleatoriamente 25 datos como muestra de la primera poblacion
prueba1 <- sample(x = var1, size = 40, replace = TRUE)

#Se extraen aleatoriamente 25 datos como muestra de la segunda poblacion
prueba2 <- sample(x = var2, size = 40, replace = TRUE)
var.test(prueba1, prueba2)
#Varianzas diferentes, se trabaja con varianzas diferente. Caso 2 o Caso 3


#Para esta funci√≥n solamente se ingresan las pruebas y el nivel de confianza.
stats::t.test(prueba1, prueba2, alternative = "two.sided", var.equal = FALSE)

```

- \n

### **Conclusi√≥n**


- \n

## **Diferencia de proporciones para dos poblaciones**

En la siguiente prueba se proceder√° a realizar los respectivos procedimientos con la distribuci√≥n normal est√°ndar, en la cu√°l se tomar√° un nivel de significancia del 95%.
Se tomaron datos correspondientes al tiempo de vuelo de los vuelos con origen en JFK y con destino en MIA como primera poblaci√≥n, del mismo modo se tomaron datos correspondientes al tiempo de vuelo de los vuelos con origen en JFK y con destino en RDU como segunda poblaci√≥n , sobre el cu√°l se quiere estimar que, la diferencia de la proporci√≥n de tiempo de aire de los vuelos de JFK a ORD con la proporci√≥n de tiempo de aire de los vuelos de JFK a RDU es igual a 0. Para esto se plantean las siguientes hip√≥tesis:   $H_0: p_1 -p_2 = 0 \\$
$H_1: p_1 -p_2 \neq 0$
Seguidamente, para validar lo planteado anteriormente, se realizar√° una prueba de hip√≥tesis para una diferencia de proporciones de dos poblaciones que se asume que siguen un comportamiento normal, utilizando un nivel de confianza de 95%, eligiremos si la prueba va a ser de cola izquierda, cola derecha o dos colas; para este caso se usar√° una prueba de dos colas.

- \n

### **Resultados**
```{r}
#En la siguiente asignaci√≥n se toman los n cantidad de vuelos que salen de JFK y tienen como destino MIA, y guarda en var1 s√≥lo los vuelos con dichas caracter√≠sticas.
prueba1 <- na.omit(dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "MIA", ]$air_time)

#Estos son los n cantidad de vuelos que salen de JFK y tienen como destino RDU
prueba2 <- na.omit(dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "ORD", ]$air_time)


#El length de p1 y p2 son los exitos de los vuelos que tienen un tiempo menor o igual a 150
exitoP1 <- length(which(prueba1 <= 150))
exitoP2 <- length(which(prueba2 <= 150))
n1 <- exitoP1/length(prueba1)
n2 <- exitoP2/length(prueba2)
nxp <- n1 * length(prueba1)
n2xp <- n2 * length(prueba2)
nxp
n2xp

#Usando la funcion de prop.test se sacan los intervalos de confianza respectivos, primero con los
#exitos de la poblaci√≥n 1 y su respectivo tama√±o, y segundo con la poblacion 2
stats::prop.test(x = c(exitoP1, exitoP2), n = c(length(prueba1), length(prueba2)))
#Usando la funcion de prop.test se sacan los intervalos de confianza respectivos, primero con los
#exitos de la poblacion 2 y su respectivo tama√±o, y segundo con la poblacion 1
#stats::prop.test(x = c(exitoP2, exitoP1), n = c(length(prueba2), length(prueba1)))

```

- \n

### **Conclusi√≥n**


- \n

## **Cociente de varianzas de dos poblaciones**

En la siguiente prueba se proceder√° a realizar los respectivos procedimientos con la distribuci√≥n F, en la cu√°l se tomar√° un nivel de significancia del 95%.
Se tomaron datos correspondientes al tiempo de vuelo de los vuelos con origen en JFK y con destino en MIA como primer poblaci√≥n, del mismo modo se tomaron datos correspondientes al tiempo de vuelo de los vuelos con origen en JFK y con destino en RDU como segunda poblaci√≥n, sobre el cu√°l se quiere contrastar igualdad en las varianzas. Para esto se plantean las siguientes hip√≥tesis:   $H_0: \frac{\sigma^2_1}{\sigma^2_2} = 1 \\$
\n
$H_1: \frac{\sigma^2_1}{\sigma^2_2} \neq 1$
Seguidamente, para validar lo planteado anteriormente, se realizar√° una prueba de hip√≥tesis para un cociente de varianzas de dos poblaciones que sigue una distribuci√≥n normal, utilizando un nivel de confianza de 95%, eligiremos si la prueba va a ser de cola izquierda, cola derecha o dos colas; para este caso se usar√° una prueba de dos colas.

- \n

### **Resultados**
```{r}
#En la siguiente asignaci√≥n se toman los n cantidad de vuelos que salen de JFK y tienen como destino MIA, y guarda en var1 s√≥lo los vuelos con dichas caracter√≠sticas.
var1 <- dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "MIA", ]

#Estos son los n cantidad de vuelos que salen de JFK y tienen como destino RDU
var2 <- dataFlight[dataFlight$origin == "JFK" & dataFlight$dest == "RDU", ]

#Para la siguiente funci√≥n se le pasa la columna de air_time de ambas variables y por √∫ltimo el nivel de confianza.
stests:: var.test( na.omit(var1$air_time),  na.omit(var2$air_time))

```

- \n

### **Conclusi√≥n**


# **Fase III**

- \n

## I PARTE: OTRAS PRUEBAS DE HIP√ìTESIS EN R 

- \n

## **CASO 1: **


```{r}

feetLength <- split(mosaicData$length, mosaicData$sex)
feetLength
#Esta funcion lo que hace es separar los datos en dos grupos, estos grupos son separados por sexo: ni√±o y ni√±a. Lo que agrega a lo que extrae es es lo que le pasamo en el primer par√°metro, en este caso el length.

```
Para cada dataset (ni√±os y ni√±as), se proceder√° a realizar un gr√°fico de la normalidad para cada uno, con el fin de analizar el comportamiento de los datos.

- \n 

## **Muestra de ni√±os**

- \n

```{r}

# Se toma la  muestra de solamente los ni√±os
muestra <- feetLength$B

par(mfrow = c(1, 2)) # crea una matriz de tama√±o 1x2 para imprimir dos gr√°ficos de manera simult√°nea

hist(muestra, main="Histograma ni√±os")
plot(density(muestra), main="Estimaci√≥n ni√±os")

plot(density(muestra), main = "Estimaci√≥n densidad")

# Se generan valores para estimar la distribuci√≥n normal de media y desviaci√≥n est√°andar de la lista de feetLength de los ni√±os

#En el from y en el to se agregan un n√∫mero menos al menor de los datos y un n√∫mero mayor al de los datos.
x <- seq(from = 21,to = 29, by = 0.01)
u <- mean(muestra)
sigma <- sd(muestra)
lines(x, dnorm(x, mean = u, sd = sigma), col = "red")

```

## **¬øSe puede intuir una posible normalidad para los datos?**

- \n En el caso de los ni√±os s√≠ se puede intuir una posible normalidad ya que como se puede apreciar en el gr√°fico anterior de la estimaci√≥n de densidad es muy parecido el comportamiento de la l√≠nea color negro que representa los datos de los ni√±os a la l√≠nea roja.

- \n

### Gr√°fico QQ-plot
- \n
```{r}
u <- mean(muestra)
sigma <- sd(muestra)


car::qqPlot(muestra, distribution = "norm",mean = u, sd = sigma)
```



- \n 
### **Pruebas formales de normalidad S-W test, A-D test,K-S-L test.** 
- \n

### ***Test de Kolmogorov-Smirnov-Lilliefors o K-S-L test***
```{r}
lillie.test(muestra)
```

- \n
En este caso la normalidad de los datos s√≠ se acepta, esto porque el valor de p es mayor a 0.05. Por lo tanto, no hay suficiente evidencia en contra para no aceptar la normalidad de los datos.
- \n

### **Test de normalidad de Anderson-Darling o A-D test**
```{r}
ad.test(muestra)
```

- \n
En este caso la normalidad de los datos s√≠ se acepta, esto porque el valor de p es mayor a 0.05. Por lo tanto, no hay suficiente evidencia en contra para no aceptar la normalidad de los datos.

- \n

### **Test de Shapito-Wilks o S-W test**
```{r}
shapiro.test(muestra)
```

- \n
En este caso no se encontr√≥ evidencia en contra para no asumir normalidad, esto porque al igual que las pruebas anteriores el valor de p dio mayor a 0.05.
- \n

### **Test omnibus de D‚ÄôAgostino-Pearson**
Si es posible realizar esta prueba porque el tama√±o de la lista para los ni√±os es de 20, por ende, si se puede realizar la prueba.

```{r}
dagoTest(muestra)
```
‚Ä¢	En este caso se aceptan la normalidad de los datos ya que todos los test fueron mayores a 0.05. 
- \n
### **Analizando los datos de la curtoris**
```{r}
  curtosis <- kurtosis(muestra)
  simetria <- skewness(muestra)
  plot (density(muestra), main = "Normal",
  xlab = paste("Curtosis ", round(curtosis, 2), "\n",
  "Simetr√≠a ", round(simetria,2)))
```
- \n
Como se puede observar la simetr√≠a es de 0.38 por lo cual se acerca al cero, por lo tanto se puede decir que es sim√©trica, ya que ambos valores que est√°n a los extremos se encuentran aproximadamente a la misma distancia de la media.
En este caso la curtosis  muestra una campana muy alta alargada y con las colas bajas por ende se puede decir que es una Leptoc√∫rtica adem√°s de que se inclina hacia la izquierda.

- \n 
## **Muestra de ni√±as**

- \n
```{r}

# Se toma la  muestra de solamente las ni√±as
muestra <- feetLength$G


par(mfrow = c(1, 2)) # crea una matriz de tama√±o 1x2 para imprimir dos gr√°ficos de manera simult√°nea

hist(muestra, main="Histograma ni√±as")
plot(density(muestra), main="Densidad ni√±as")

plot(density(muestra), main = "Estimaci√≥n densidad")

# Se generan valores para estimar la distribuci√≥n normal de media y desviaci√≥n est√°andar igual a los datos de la lista de feetLength de los ni√±os

#En el from y en el to se agregan un n√∫mero menos al menor de los datos y un n√∫mero mayor al de los datos.
x <- seq(from = 20,to = 28, by = 0.01)
u <- mean(feetLength$G)
sigma <- sd(feetLength$G)
lines(x, dnorm(x, mean = u, sd = sigma), col = "red")

```


## **¬øSe puede intuir una posible normalidad para los datos?**

- \n En el caso de las ni√±as s√≠ se puede intuir una posible normalidad ya que como se puede apreciar en el gr√°fico anterior de la estimaci√≥n de densidad es muy parecido el comportamiento de la l√≠nea color negro que representa los datos de las ni√±as a la l√≠nea roja.

- \n 

### Gr√°fico QQ-plot
- \n
```{r}
u <- mean(muestra)
sigma <- sd(muestra)


car::qqPlot(muestra, distribution = "norm",mean = u, sd = sigma)
```

- \n 


- \n 
### **Pruebas formales de normalidad S-W test, A-D test,K-S-L test.** 
- \n

### ***Test de Kolmogorov-Smirnov-Lilliefors o K-S-L test***
```{r}
lillie.test(muestra)
```

- \n
En este caso la normalidad de los datos s√≠ se acepta, esto porque el valor de p es mayor a 0.05. Por lo tanto, no hay suficiente evidencia en contra para no aceptar la normalidad de los datos.
- \n

### **Test de normalidad de Anderson-Darling o A-D test**
```{r}
ad.test(muestra)
```

- \n
En este caso la normalidad de los datos s√≠ se acepta, esto porque el valor de p es mayor a 0.05. Por lo tanto, no hay suficiente evidencia en contra para no aceptar la normalidad de los datos.

- \n

### **Test de Shapito-Wilks o S-W test**
```{r}
shapiro.test(muestra)
```

- \n
En este caso no se encontr√≥ evidencia en contra para no asumir normalidad, esto porque al igual que las pruebas anteriores el valor de p dio mayor a 0.05.
- \n

### **Test omnibus de D‚ÄôAgostino-Pearson**
En este caso no posible realizar la prueba, debido a que el tama√±o de lista para las ni√±as es de 19, y por ende, no puede aplicarse la prueba.

- \n

### **Analizando datos de la curtoris**

```{r}
  curtosis <- kurtosis(muestra)
  simetria <- skewness(muestra)
  plot (density(muestra), main = "Normal",
  xlab = paste("Curtosis ", round(curtosis, 2), "\n",
  "Simetr√≠a ", round(simetria,2)))

```

Como se puede observar la simetr√≠a es de -0.05 por lo cual es menor a cero, por lo tanto, se puede decir que no es sim√©trica, indicando que el valor mayor est√° m√°s cerca de la media que el valor menor. En este caso la curtosis muestra una campana muy alta alargada y con las colas bajas por ende se puede decir que es una Leptoc√∫rtica adem√°s de que se inclina hacia la izquierda.

- \n

## **CASO 2: **

- \n
Se proceder√° a realizar un gr√°fico de normalidad con el fin de analizar el comportamiento de los datos de b√≠ceps.
- \n

## **Muestra de b√≠ceps**

- \n

A continuaci√≥n se utilizar√°n los datos de biceps de la tabla medidas_cuerpo.

```{r}
url <- 'https://raw.githubusercontent.com/fhernanb/datos/master/medidas_cuerpo' 
muestra <- read.table(file=url, header=T) 
muestra <- muestra$biceps
muestra

par(mfrow = c(1, 2)) # crea una matriz de tama√±o 1x2 para imprimir dos gr√°ficos de manera simult√°nea

hist(muestra, main="Histograma biceps")
plot(density(muestra), main="Estimaci√≥n biceps")

plot(density(muestra), main = "Estimaci√≥n densidad")

# Se generan valores para estimar la distribuci√≥n normal de media y desviaci√≥n est√°ndar de los biceps

#En el from y en el to se agregan un n√∫mero menos al menor de los datos y un n√∫mero mayor al de los datos.
x <- seq(from = 10,to = 50, by = 0.01)
u <- mean(muestra)
sigma <- sd(muestra)
muestra
lines(x, dnorm(x, mean = u, sd = sigma), col = "red")


```

## **¬øSe puede intuir una posible normalidad para los datos?**

- \n En este caso no se puede intuir ya que a como se puede observar en el gr√°fico anterior el comportamiento que toma la l√≠nea color negro es muy distinta.


- \n 

### Gr√°fico QQ-plot
- \n
```{r}
u <- mean(muestra)
sigma <- sd(muestra)


car::qqPlot(muestra, distribution = "norm",mean = u, sd = sigma)

```
- \n 
### **Pruebas formales de normalidad S-W test, A-D test,K-S-L test.** 
- \n

### **Test de Kolmogorov-Smirnov-Lilliefors o K-S-L test**
```{r}
lillie.test(muestra)
```

- \n
En este caso la normalidad de los datos  se acepta, esto porque el valor de p es mayor a 0.05. Por lo tanto, no hay suficiente evidencia para no aceptar la normalidad de los datos.
- \n

### **Test de normalidad de Anderson-Darling o A-D test**
```{r}
ad.test(muestra)
```

- \n
En este caso la normalidad de los datos no se acepta, esto porque el valor de p es menor a 0.05. Por lo tanto, no hay suficiente evidencia para aceptar la normalidad de los datos.

- \n

### **Test de Shapito-Wilks o S-W test**
```{r}
shapiro.test(muestra)
```

- \n
En este caso se encontr√≥ evidencia en contra para no asumir normalidad, esto porque al igual que las pruebas anteriores el valor de p dio menor a 0.05.
- \n

### **Test omnibus de D‚ÄôAgostino-Pearson**

- \n 

Si es posible realizar esta prueba porque el tama√±o de la lista para los biceps es de 36, por ende, si se puede realizar la prueba.
```{r}
dagoTest(muestra)
```
‚Ä¢	En este caso no se acepta la normalidad de los datos ya que dos de las pruebas son menores a 0.05. 

- \n

### **Analizando datos de la curtoris**

```{r}
  curtosis <- kurtosis(muestra)
  simetria <- skewness(muestra)
  plot (density(muestra), main = "Normal",
  xlab = paste("Curtosis ", round(curtosis, 2), "\n",
  "Simetr√≠a ", round(simetria,2)))

```

observar la simetr√≠a es de 0.01 por lo cual se acerca mucho al cero, por lo tanto se puede decir que es sim√©trica, ya que ambos valores que est√°n a los extremos se encuentran aproximadamente a la misma distancia de la media. La curtosis se puede denotar un poco inclinada hacia la derecha y por lo que no es muy alta y su punta semi redonda se puede decir que es Mesoc√∫rtica.
- \n

## **CASO 3: **

- \n

```{r}
chisq.test(matrix(c(12,379,727,39,106,642),2,3))

```

- \n

## **CASO 4: **

- \n

```{r}
datos <- read.csv("desaceleracionPecho.csv", sep = ";")
head(datos, 27)
aov(Mediciones ~ Auto.Tipo, data = datos)
summary(aov(Mediciones ~ Auto.Tipo, data = datos))
desaceleracionPecho <- aov(Mediciones ~ Auto.Tipo , data = datos)

#Pasamo la prueba ANOVa a la prueba Tuckey
TukeyHSD(desaceleracionPecho)
```

- \n

## **CASO 5: ** 

```{r}
grasas <- read.table('http://verso.mat.uam.es/~joser.berrendero/datos/EdadPesoGrasas.txt', header = TRUE)

#summary(grasas)

dataCor <- round( cor(grasas), 2 )

dataCor
```

```{r}
ggcorrplot(dataCor, method = "square")

```


- \n
Se puede observar que existen correlaciones perfectas ya que son los datos que arrojan exactamente 1.0, este tipo de correlaciones se obtienen ya que se realizan con la misma variable, por ejemplo: peso con peso, grasa con grasa y edad con edad.

Tambi√©n, se puede observar que la correlaci√≥n entre las variables edad y grasas las cuales poseen un valor de 0.84, el cual es un valor cercano al 1, por lo que esta misma es considerada como una correlaci√≥n positiva fuerte, por otra parte, el valor presentado entre el peso y edad corresponde a 0.24 y el valor entre peso y grasas corresponde a 0.27; estos valores presentados anteriormente se encuentran alejados del 1, por lo que se puede concluir que se tratan de correlaciones positivas d√©biles.

- \n

```{r}
regresionLineal <- lm(grasas ~ edad, data = grasas)
regresionLineal
```
- \n

Por lo tanto, el modelo de RLS para los datos seleccionados ser√≠a: $grasas = 102.575 + 5.321 \cdot edad$ 

- \n

## Coeficiente de determinaci√≥n 
```{r}
summary(lm(grasas ~ edad, data = grasas))$r.squared
```
## Coeficiente de correlaci√≥n

```{r}
sqrt(summary(lm(grasas ~ edad, data = grasas))$r.squared)
```
En el caso anterior se puede indicar que, como $R = 0.8373534$ la correlaci√≥n lineal entre los datos de edad y grasas es fuerte y positiva. Por otra parte, como $R^2 = 0.7011607$ se interpreta que la variaci√≥n de las grasas, se debe a la variaci√≥n que existe en la edad. El restante 30% se deben a otros factores.  

- \n

```{r}
gg_dispersion <- ggplot(grasas, aes(edad, grasas))
gg_dispersion + geom_point( alpha = 0.5 ) + geom_smooth(method = "lm")
```
- \n
Observando el gr√°fico se puede notar por la direcci√≥n de los datos y tambi√©n por la recta de ajuste, se puede concluir que se obtiene una correlaci√≥n positiva. Tambi√©n, al observar que los puntos se encuentran cercanos a la recta de ajuste se define como una correlaci√≥n m√°s o menos fuerte.

- \n

```{r}  
b0 <- 102.575
b1 <- 5.321

grasas.estimada <- b0 + b1*grasas$edad
errores <- grasas.estimada - grasas$grasas
lillie.test(errores)
```
Dado que el valor de P es mayor que la significancia se puede asumir que los datos se comportan con normalidad.

- \n

```{r}
confint(lm(grasas$grasas ~ grasas$edad),level = 0.95)
```
Seg√∫n los datos arrojados por el m√©todo "confint" se muestra que el intervalo de confianza corresponde a ]3.822367, 6.818986[

- \n

# Confianza
```{r}

x0 <- data.frame(edad = 27)
predict.lm(regresionLineal, x0, interval = "confidence", level = 0.95 )

```

Se afirma que con el 95% de la confianza se puede afirmar que el valor de ùúáde los valores Y asociados al X = 27, donde X representa los a√±os de edad, se encuentran en el siguiente intervalo: ]220.6777, 271.7891[

- \n
# Predicci√≥n
```{r}
modelo <- lm(edad ~ grasas, data = grasas)

#Promedio del intervalo de confianza
promValores = (271.7891 + 220.6777) / 2


x0_1 <- data.frame( grasas = promValores  )

predict.lm(modelo, x0_1, interval = "prediction", level = 0.95)
```
- \n

Con el 95% de confianza se puede afirmar que el verdadero valor deùúáde los X que se encuentran asociados al promedio del intervalo de confianza Y = 246.2334 en cantidad de grasa, se encuentra en el intervalo ]15.99538 45.24849[

\n 

```{r}
modelo <- lm(grasas ~ edad, data = grasas)
summary(modelo)

```

Se puede notar que el valor de p es m√°s peque√±o con respecto al valor de alpha el cual es de 0.05, por lo cual se rechaza la hip√≥tesis $H_0$, por lo que se puede considerar que ocurre independencia l√≠neal entre las variables edad y grasa debido a que la pendiente es $\neq$ a 0

\n

## **CASO 6: **

```{r}
datosVentas <- read.csv('DatosVentas.csv', header = TRUE)

str(datosVentas)
```

```{r}
mod0 <- lm(ventas ~ tv, data = datosVentas)
mod0

summary(mod0)
```

La ecuaci√≥n para el modelo RLS para los datos es: $ventas = 7.032594 + 0.047537 ‚ãÖ tv$
\n


```{r}
mod1 <- lm(ventas ~ tv + radio + periodico, data = datosVentas )
summary(mod1)


```
Ecuaci√≥n provisional del modelo a determinar: $ventas = b0 + b1tv + b2radio + b3*peri√≥dico$

Ecuaci√≥n del modelo estimado: $ventas = 2.938889 + 0.045765tv + 0.188530\cdot radio - 0.001037\cdot periodico$

Los coeficientes que aportan al modelo son los que poseen un valor menor con respecto al nivel de significancia de la prueba, que en este caso el alpha posee un valor de $\alpha = 0.05$, por lo que se rechaza la hip√≥tesis nula que determina la pendiente igual a 0.
De esta manera, los coeficientes estad√≠sticamente significativos con los cuales se puede asumir que la pendiente es diferente de 0 son: el coeficiente tv, el coeficiente radio como el intercepto, los cuales tienen un valor $2e^-16$.
Por lo que al rechazar $H_0$, se muestra que existe dependencia lineal entre las variables.

- \n


```{r}
mod2 <- lm(ventas ~ tv + radio, data = datosVentas )

summary(mod2)
 
```
Con los datos obtenidos todos los coeficientes son significativos, ya que estos tiene un valor p menor al la significancia de la prueba.


- \n
```{r}
mod3 <- lm(ventas ~ tv + radio + tv*radio, data = datosVentas)

summary(mod3)

```
Los coeficientes mostrados son estad√≠sticamente significativos ya que todos muestran un valor p menor al valor de la significancia de la prueba $\alpha = 0.05$

- \n

```{r}
#Determinaci√≥n
summary(mod0)$r.squared

#Correlaci√≥n
sqrt(summary(mod0)$r.squared)

#Determinaci√≥n
summary(mod1)$r.squared

#Correlaci√≥n
sqrt(summary(mod1)$r.squared)

#Determinaci√≥n
summary(mod2)$r.squared

#Correlaci√≥n
sqrt(summary(mod2)$r.squared)

#Determinaci√≥n
summary(mod3)$r.squared

#Correlaci√≥n
sqrt(summary(mod3)$r.squared)

```

#Se pega la tabla

#Mejor modelo con respecto a los otros

Al analizar los datos arrojados de los coeficientes se concluye que el mejor modelo obtenido con respecto a los 4 analizados es el mod3, ya que este cuenta con mayor correlaci√≥n y determinaci√≥n. Este modelo seleccionado al tener el valor del coeficiente de correlaci√≥n de 0.9837635, muestra que sus datos no poseen una dispersi√≥n significante con respecto al modelo y finalmente el valor del coeficiente de determinaci√≥n de 0.9677905 demuestra el resultado de las ventas con respecto a las variables que se utilizaron.


# Correlaci√≥n y determinaci√≥n mod2 

El coeficiente de correlaci√≥n al encontrarse tan cercano al 1 demuestra que que posee una correlaci√≥n positiva y fuerte, esto indica que los datos no poseen una dispersi√≥n significante con respecto al modelo.

Finalmente, el valor obtenido del coeficiente de determinaci√≥n es de 0.8971943 determina que aproximadamente el 89.71% en la variaci√≥n de las ventas se debe a la variaci√≥n publicada a trav√©s de la televisi√≥n (tv) y radio.

- \n

```{r}
dim(datosVentas)
```
```{r}

AICctab(mod0, mod1, mod2, mod3, base = T, delta = T, sort = T, weights = T, nobs = 200)
```
Al realizar el c√°lculo con el AIC para cada modelo, el orden arrojado se define de mejor a menor junto con el valor de AIC obtenido respectivamente. 

- \n

```{r}
exp_lm0 <- DALEX::explain(mod0, data = datosVentas, label = "lm0", y = datosVentas$ventas) 
```


```{r}
exp_lm2 <- DALEX::explain(mod2, data = datosVentas, label = "lm2", y = datosVentas$ventas) 
```


```{r}
exp_lm3 <- DALEX::explain(mod3, data = datosVentas, label = "lm3", y = datosVentas$ventas)
```
#Performances



```{r}
pm0 <- model_performance(exp_lm0)
pm2 <- model_performance(exp_lm2)
pm3 <- model_performance(exp_lm3)

plot(pm0,pm2, pm3)
```


Al analizar el gr√°fico mostrado, se concluye que el modelo con menor curva es el modelo que corresponde al mod3 ya que al poseer una curva tan baja se determina que este es el mejor de los tres modelos graficados.
Para la selecci√≥n anterior se utiliza el criterio de que el mejor modelo es el que presente menor curva, ya que esto significa que contiene el valor m√°s peque√±o de errores.

- \n

```{r}
anova(mod0, mod1, mod2, mod3)
```
Al analizar los datos arrojados el mod3 es el que posee un menor RSS con respecto a los dem√°s modelos analizados, el cual obtuvo un valor de 174,48 con lo cual se logra determinar que es el mejor modelo ya que los puntos se encuentran mayor ajustados.

- \n 
## **CASO 7: *

- \n

```{r}
var <- read.table("jaws.txt",header=T) 
var
ggplot2::ggplot(var,aes(x = age, y = bone)) +
  geom_point(shape = 21, width = 0.3, alpha = 0.4, fill = "blue", size = 1, stroke = 1)
# en lugar de geom_point(), tambi√©n puede usar geom_jitter()

```

```{r}
model1 <-  stats::nls(bone~a*(1-exp(-c*age)),data = var, start=list(a=120,c=0.064))
model1
```
$ y = a(1- e^{-c x })$ 
$y = 115.5806(1-e^{(0.1188)*age})$

```{r}
X2 <- log(var$age)
Y2 <- log(var$bone-115.5806)
datos4 <- cbind(X2, Y2)
datos4.df <- as.data.frame(datos4)
modelolm <- lm(Y2 ~ 0 + X2, data = datos4.df) #Intercepto igual a cero
modelolm
```

$y = 115.5806 + x^{(0.3945)}$
```{r}
xo <- seq(from = min(var$age), to = max(var$age) , by = 0.001)
yo <- 115.5806*(1-exp(-0.1188*xo))
data <- cbind(var$age, var$bone, xo, yo) # se juntan las columnas
data.df <- as.data.frame(data) # se crea un objeto dataframe
names(data.df) # verificamos los nombres de las columnas
g3 <- ggplot(data.df, aes(V1, V2, xmin = 0, xmax = 55, ymin = 0, ymax = 150 ))

g3 + geom_point(shape = 21, alpha = 0.4, fill = "red", size = 1, stroke = 1) +geom_line(aes(x = xo, y = yo), colour = "darkblue") + 
  labs(colour = "Modelo RNLS")


```
El segundo modelo ser√°: $ y= \alpha \cdot x^\beta $
Se linealiza el modelo de la siguiente manera:
  $ln(y) = ln(\alpha) + \beta ln(x)$
Se realizan los siguientes cambios de variable para el modelo lineal:
$X2 = ln(x), Y2 = ln(y), b_0 =ln(\alpha), b_1 = \beta$
Ahora el modelo lineal a trabajar es el siguiente:
$Y2= b_0 + b_1 X2$

```{r}

X2 <- log(var$age)
Y2 <- log(var$bone)
datosSegundoModelo <- cbind(X2, Y2)
datosSegundoModelo.df <- as.data.frame(datosSegundoModelo)
modelolm <- lm(Y2 ~ X2, data = datosSegundoModelo.df[-1,] ) #Intercepto igual a cero
modelolm
```
De los resultados del modelo se tiene:
$ \alpha = e^{(2.9462)}, \beta = 0.5155$
Seguidamente se utilizan estos valores como condiciones iniciales para estimar el modelo
$ y= \alpha \cdot x^\beta $, usando la funci√≥n nls().
```{r}
model2 <-  stats::nls(bone~a*age^b,data = var, start=list(a=exp(2.9462),b=0.5155))
model2
```
```{r}
xo <- seq(from = min(var$age), to = max(var$age) , by = 0.001)
yo <- 35.2926*xo^0.3279
data <- cbind(var$age, var$bone, xo, yo) # se juntan las columnas
data.df <- as.data.frame(data) # se crea un objeto dataframe
names(data.df) # verificamos los nombres de las columnas
g3 <- ggplot(data.df, aes(V1, V2, xmin = 0, xmax = 55, ymin = 0, ymax = 150 ))

g3 + geom_point(shape = 21, alpha = 0.4, fill = "red", size = 1, stroke = 1) +geom_line(aes(x = xo, y = yo), colour = "darkblue") + 
  labs(colour = "Modelo RNLS")
```

- \n
Elegiendo el mejor modelo de los dos anteriormente creados:

- \n

```{r}
stats::anova(model1,model2)
```
En este caso, tanto gr√°ficamente como infiriendo un an√°lisis de las sumas de los cuadrados de los residuos (Res.Sum Sq), se lleg√≥ a la conclusi√≥n que el mejor modelo es el modelo n√∫mero uno(model1).
Adem√°s, la funci√≥n potencial del primer modelo (model1), tiende a estabilizarse como al final de la funci√≥n, a diferencia del segundo modelo que tiende como a desbalancearse. Adem√°s, cuando empieza la curva tenemos datos muy dispersos hacia arriba en el segundo modelo,caso contrario al primero. Es por estas razones que se concluye que el mejor modelo tanto gr√°fica como por medio de las sumas de los cuadrados de los residuos, que el primer modelo es el mejor y m√°s √≥ptimo.















